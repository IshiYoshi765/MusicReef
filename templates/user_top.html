<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://use.fontawesome.com/releases/v5.15.3/css/all.css" rel="stylesheet"/>
    <link rel="icon" href="{{url_for('static', filename='favicon/mr„É≠„Ç¥.ico')}}"/>
    <link rel="stylesheet" href="{{url_for('static', filename='/css/user_top.css')}}">
    <title>Âà©Áî®ËÄÖ„Éà„ÉÉ„Éó</title>
  </head>
  <body>
    <ul class="topnav">
      <li>
        <a class="left" href="{{url_for('user_top')}}"><h2>„ÄÄMUSIC REEF</h2></a>
      </li>
      <li class="right">
        <a
          href="{{url_for('terms_of_service')}}"
          style="border-left: 2px solid white; padding: 2px 8px"
          ><h2>Âà©Áî®Ë¶èÁ¥Ñ</h2></a
        >
      </li>
    </ul>
    <div style="background-color: #ececec; margin: 0; height: 120px">
      <h3 class="title1">„Éï„É™„ÉºÈü≥Ê∫ê„ÅÆÊ§úÁ¥¢</h3>
      <div class="search-box">
        <form action="{{url_for('search_music_result')}}" method="post">
          <select name="genre">
            <option value="">ÊåáÂÆö„Åó„Å™„ÅÑ</option>
            <option value="2">„Éù„ÉÉ„Éó</option>
            <option value="3">EDM</option>
            <option value="4">„É≠„ÉÉ„ÇØ</option>
            <option value="5">„ÇØ„É©„Ç∑„ÉÉ„ÇØ</option>
            <option value="6">ÂíåÈ¢®</option>
            <option value="7">„Éî„Ç¢„Éé</option>
            <option value="8">„Ç¢„É≥„Éì„Ç®„É≥„Éà</option>
            <option value="9">„Ç®„É¨„ÇØ„Éà„É≠</option>
            <option value="10">„Ç¢„Ç≥„Éº„Çπ„ÉÜ„Ç£„ÉÉ„ÇØ</option>
            <option value="11">Chill Hop</option>
          </select>      
  
          <input type="text" class="tagInput" placeholder="Ê§úÁ¥¢„ÉØ„Éº„Éâ" name="name">
            <input type="hidden" name="page" value="{{ page }}"> 
                <button type="submit">
                  <i class="fas fa-search fa-fw"></i>
                </button>      
        </form>
      </div>
    </div>
    <div class="expression">
      <p class="p1">music search</p>
      <p class="p2" style="margin: 0; padding-top: 15px; padding-left: 20px">Êñ∞ÁùÄ</p>
      <ul>
        {% if recent_music %}
          {% for music in recent_music %}
          <li class="music-entry" style="margin-left: 40px">
            <div class="logo-container">
              {% set logo_keyword = music[8]|lower %}
              {% if 'bgmer' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/BGMer.jpg') }}" alt="BGMer „É≠„Ç¥"/>
              {% elif 'amachamusic' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/amatya.jpg') }}" alt="Amatya „É≠„Ç¥"/>
              {% elif 'dova-s.jp' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/dova.jpg') }}" alt="Dova „É≠„Ç¥"/>
              {% elif 'musmus.main.jp' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/MusMus.jpg') }}" alt="MusMus „É≠„Ç¥"/>
              {% elif 'shw.in' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/SHW.jpg') }}" alt="SHW „É≠„Ç¥"/>
              {% else %}
                <div class="no-image">No image</div>
              {% endif %}
            </div>
            <div class="music-info-container">
              <p class="music-title">{{ music[1] }}</p>
              <p class="music-info">‰ΩúÊõ≤: {{ music[6] }}</p>
              <p class="music-info">‚ô¨ {{ music[4] }}</p>
              <p class="music-info">
                {% set genre_options = {
                   '1': 'ÊåáÂÆö„Åó„Å™„ÅÑ', 
                   '2': '„Éù„ÉÉ„Éó', 
                   '3': 'EDM', 
                   '4': '„É≠„ÉÉ„ÇØ', 
                   '5': '„ÇØ„É©„Ç∑„ÉÉ„ÇØ', 
                   '6': 'ÂíåÈ¢®', 
                   '7': '„Éî„Ç¢„Éé', 
                   '8': '„Ç¢„É≥„Éì„Ç®„É≥„Éà', 
                   '9': '„Ç®„É¨„ÇØ„Éà„É≠', 
                   '10': '„Ç¢„Ç≥„Éº„Çπ„ÉÜ„Ç£„ÉÉ„ÇØ', 
                   '11': 'Chill Hop', 
                } %} 
                {{genre_options[music[2]] }}
              </p>
              <p class="music-info">üëÅ {{ music[11] }}Âõû</p>
              <div class="detail-cursor" data-music-id="{{ music[0] }}">Ë©≥Á¥∞„Å™ÊÉÖÂ†±</div>
              <div class="music-details-container" id="music-details-{{ music[0] }}">
                <div class="details-box">
                  <div class="tooltip"></div>
                    {% if music[13] != None%}
                      <p>{{music[13]}}</p>
                    {% else %}
                      <p>Âà©Áî®ÂèØËÉΩ„Å™„Çø„Ç∞„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
                    {% endif %}
                  <br>
                  <p>{{ music[3] }}</p>
                  <br>
                </div>
              </div>
            </div>
            <div class="music-actions">
              <a href="{{ url_for('review', music_id=music[0]) }}" class="review">Ë©ï‰æ°<br>
                {% if average_ratings and music[0] in average_ratings %}
                  <span>{{ average_ratings[music[0]] | round(1) }}/5</span>
                {% else %}
                  <span>-/5</span>
                {% endif %}
              </a>
              <div class="download-action">
                {% if music[8] %}
                  <a href="{{ url_for('download_music', music_id=music[0]) }}" class="download-link">„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</a>
                {% else %}
                  <span>N/A</span>
                {% endif %}
              </div>
            </div>
          </li>
          {% endfor %}
        {% endif %}
      </ul>

      <p class="p3" style="margin: 0; padding-top: 15px; padding-left: 20px">„Ç¢„ÇØ„Çª„ÇπÊï∞„É©„É≥„Ç≠„É≥„Ç∞</p>
      <br/>
      <ul>
        {% if week_top_songs %}
          {% for music in week_top_songs %}
          <p style="
            font-size: 30px;
            text-align: left;
            padding-top: 40px;
            margin-left: -10px; 
            margin-bottom: -100px;
            color: {% if loop.index == 1 %}yellow{% elif loop.index == 2 %}gray{% elif loop.index == 3 %}brown{% else %}black{% endif %};">
            {{ loop.index }}
          </p>
          <li class="music-entry" style="margin-left: 40px">   
            <div class="logo-container">
              {% set logo_keyword = music[8]|lower %}
              {% if 'bgmer' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/BGMer.jpg') }}" alt="BGMer „É≠„Ç¥"/>
              {% elif 'amachamusic' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/amatya.jpg') }}" alt="Amatya „É≠„Ç¥"/>
              {% elif 'dova-s.jp' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/dova.jpg') }}" alt="Dova „É≠„Ç¥"/>
              {% elif 'musmus.main.jp' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/MusMus.jpg') }}" alt="MusMus „É≠„Ç¥"/>
              {% elif 'shw.in' in logo_keyword %}
                <img class="logo-img" src="{{ url_for('static', filename='img/SHW.jpg') }}" alt="SHW „É≠„Ç¥"/>
              {% else %}
                <div class="no-image">No image</div>
              {% endif %}
            </div>
            <div class="music-info-container">
              <p class="music-title">{{ music[1] }}</p>
              <p class="music-info">‰ΩúÊõ≤: {{ music[6] }}</p>
              <p class="music-info">‚ô¨ {{ music[4] }}</p>
              <p class="music-info">
                {% set genre_options = {
                  '1': 'ÊåáÂÆö„Åó„Å™„ÅÑ', 
                  '2': '„Éù„ÉÉ„Éó', 
                  '3': 'EDM', 
                  '4': '„É≠„ÉÉ„ÇØ', 
                  '5': '„ÇØ„É©„Ç∑„ÉÉ„ÇØ', 
                  '6': 'ÂíåÈ¢®', 
                  '7': '„Éî„Ç¢„Éé', 
                  '8': '„Ç¢„É≥„Éì„Ç®„É≥„Éà', 
                  '9': '„Ç®„É¨„ÇØ„Éà„É≠', 
                  '10': '„Ç¢„Ç≥„Éº„Çπ„ÉÜ„Ç£„ÉÉ„ÇØ', 
                  '11': 'Chill Hop', 
                } %} 
                {{genre_options[music[2]] }}
              </p>
              <p class="music-info">üëÅ {{ music[11] }}Âõû</p>
              <div class="detail-cursor" data-music-id="{{ music[0] }}">Ë©≥Á¥∞„Å™ÊÉÖÂ†±</div>
              <div class="music-details-container" id="music-details-{{ music[0] }}">
                <div class="details-box">
                  <div class="tooltip"></div>
                    {% if music[12] != None %}
                      <p>{{music[12]}}</p>
                    {% else %}
                      <p>Âà©Áî®ÂèØËÉΩ„Å™„Çø„Ç∞„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
                    {% endif %}
                  <br>
                  <p>{{ music[3] }}</p>
                  <br>
                </div>
              </div>
            </div>
            <div class="music-actions">
              <a href="{{ url_for('review', music_id=music[0]) }}" class="review">Ë©ï‰æ° <br>
                {% if average_ratings and music[0] in average_ratings %}
                  <span>{{ average_ratings[music[0]] | round(1) }}/5</span>
                {% else %}
                  <span>-/5</span>
                {% endif %}
              </a>
              <a class="download-action">
                {% if music[8] %}
                  <a href="{{ url_for('download_music', music_id=music[0]) }}" class="download-link">„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</a>
                {% else %}
                  <span>N/A</span>
                {% endif %}
              </a>
            </div>
          </li>
          {% endfor %} 
        {% endif %}
      </ul>

    <br/><br/>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        var detailCursors = document.querySelectorAll(".detail-cursor");

        detailCursors.forEach(function (cursor) {
          cursor.addEventListener("mouseover", function () {
            var musicId = this.getAttribute("data-music-id");
            var musicDetails = document.getElementById(
              "music-details-" + musicId
            );
            var tooltip = musicDetails.querySelector(".tooltip");
            var detailsBox = musicDetails.querySelector(".details-box");

            if (musicDetails) {
              var rect = this.getBoundingClientRect();
              musicDetails.style.display = "block";

              detailsBox.style.display = "block";
            }
          });

          cursor.addEventListener("mouseout", function () {
            var musicId = this.getAttribute("data-music-id");
            var musicDetails = document.getElementById(
              "music-details-" + musicId
            );
            var tooltip = musicDetails.querySelector(".tooltip");
            var detailsBox = musicDetails.querySelector(".details-box");

            if (musicDetails) {
              musicDetails.style.display = "none";
              tooltip.style.display = "none";
              detailsBox.style.display = "none";
            }
          });
        });
      });
    </script>

    <div class="footer04">
      <h1>MUSIC REEF</h1>
      <ul class="menu">
        <li><a href="#">„Éõ„Éº„É†</a></li>
        <li>
          <a href="{{url_for('about_the_site')}}"
            >MUSIC REEF(„Éü„É•„Éº„Ç∏„ÉÉ„ÇØ„É™„Éº„Éï)„Å´„Å§„ÅÑ„Å¶</a
          >
        </li>
      </ul>
    </div>
  </body>
</html>
